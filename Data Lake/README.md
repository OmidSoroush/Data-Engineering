# Project Description

A company called Sparkify wants to analyze their collected data on songs and user activity on their music streaming app. They want to know what songs users are listening to. They want to be able to query the data easily. The data resides currently resides on the app in JSON format.

This project will do the following steps in oder to enable Sparkify to access and query the data easily:

First, an ETL pipeline will be built to extract the data from the data lake hosted on S3. Second, the data will be processed  using Spark on an EMR cluster using AWS. Finally, the data will be loaded back into S3 as a set of dimensional tables in parquet format.

These tables will help Sparkify to find what songs users are listening to.


# How to run this project
First, we need to create a configuration file dl.cfg with the following data:

`KEY=YOUR_AWS_ACCESS_KEY
SECRET=YOUR_AWS_SECRET_KEY`

Second, a S3 Bucket named sparkify-dend should be created to store the processed data in. 

Finally, run the following command:

`python etl.py`


# The database schema design and ETL pipeline
The ETL pipeline creates a Relational Database Schema which will enable Sparkify to analyze their data. 

Specifically, a star scheme Relational Database enables the company to view the user behaviour over several dimensions. The Star Schema consists of a fact table and many dimension tables. The fact table is used to store all user song activities that contain the category "NextSong". The dimension tables related to the fact table are users, songs, artists and time.

## Fact Table:

### songplays
This table contains the following columns:
songplay_id, start_time, user_id, level, song_id, artist_id, session_id, location, user_agent

## Dimension Tables:
### users
user_id, first_name, last_name, gender, level

## songs
song_id, title, artist_id, year, duration

## artists 
artist_id, name, location, lattitude, longitude

## time
start_time, hour, day, week, month, year, weekday

# Dataset for this project
The data is queried from s3 buckets on AWS

Song data: s3://udacity-dend/song_data
Log data: s3://udacity-dend/log_data

The Song dataset is a subset of real data from the Million Song Dataset. Each file contains metadata about a song and the artist of that song in JSON format.

The log dataset consists of log files in JSON format generated by this event simulator based on the songs in the song dataset. The log files in the dataset are partitioned by year and month.
